package templates

//APIClientTemplate is the template for generating the client SDK
var APIClientTemplate = `"""
# Code generated by sdkgen
# DO NOT EDIT!.

"""
from vax.environment import Environment
from .transport import _get_connection
import api

from .._generated import {{range .Services }}{{.PyFileName}}{{end}}{{range .NonServiceProtos }}, {{.PyFileName}}{{end}}


{{range .Services }}{{ $svc := . }}
class _{{.Name}}Client(object):
    """
    {{ .Name }} Client
    This client is thread-safe and should be reused.  Instantiating this object opens connections and keeps them alive
    to increase RPC performance.
    """

    def __init__(self, host, scope, service_account, environment=Environment.LOCAL, cache=None):
        """ constructor """
        self.__connection = _get_connection(host, scope, service_account, environment, cache=cache)
	{{range .RPCS }}
    def {{.Name}}(self{{ range $_, $arg := .ArgsList}}, {{ $arg }}=None{{ end }}):
        req = {{$svc.PyFileName}}.{{.RequestClassName}}({{ .RequestConstructorArgs }})
        {{ if eq .ResponseIsEmpty true -}}
        self.__connection.{{.Name}}(req)
        return True
        {{- end -}}
        {{- if eq .ResponseIsEmpty false -}}
        resp = self.__connection.{{.Name}}(req)
        return api.{{ .ResponseClassName }}.from_proto(resp)
        {{- end }}
{{end}}{{end}}
`
