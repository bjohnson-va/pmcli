syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "google/api/annotations.proto";

package listingscore.v1;

// Relevant percentiles for computing letter grades and industry stats
message Percentiles {
    float ninety_fifth = 1;
    float eightieth = 2;
    float fiftieth = 3;
    float twentieth = 4;
    float tenth = 5;
}

// A model definition for industry stats average and relevant percentiles
message IndustryStats {
    float average = 1;
    Percentiles percentiles = 2;
}

// A model definition for historical score data and required time format
message HistoricalScoreDataPoint {
    // The listing score
    int64 score = 1;
    // The timestamp for listing score
    google.protobuf.Timestamp timestamp = 2;
}

// A request for getting the listing score for an account
message GetScoreRequest {
    // The unique identifier of the account group.
    string account_group_id = 1;
}


// A request for creating the listing score for an account
message CreateScoreRequest {
    // The unique identifier of the account group.
    string account_group_id = 1;
}

// A request for getting the industry stats for a taxonomy
message GetIndustryStatsRequest {
    // The unique identifier of the taxonomy.
    string taxonomy_id = 1;
    // The unique identifier of the country.
    string country = 2;
    // The unique identifier of the state.
    string state = 3;
    // The unique identifier of the city.
    string city = 4;
}

// A request for getting the historical score for an account
message GetHistoricalScoreDataRequest {
    // The unique identifier of the account group.
    string account_group_id = 1;
}

// A request for getting the listing presence data for an account
message GetListingPresenceRequest {
    // The unique identifier of the account group.
    string account_group_id = 1;
}

// A request for getting the listing accuray data for an account
message GetListingAccuracyRequest {
    // The unique identifier of the account group.
    string account_group_id = 1;
}

// A response containing the listing score for an account
message GetScoreResponse {
    // The unique identifier of the account group.
    string account_group_id = 1;
    // The listing score of the account group.
    int64 score = 2;
    // The last updated timestamp for the account
    google.protobuf.Timestamp updated = 3;
}

// A response containing the listing score for an account
message CreateScoreResponse {
    // The listing score of the account group.
    int64 score = 1;
}

// A response containing the industry stats for a taxonomy
message GetIndustryStatsResponse {
    // The industry stats based on world
    IndustryStats world = 1;
    // The industry stats based on country
    IndustryStats country = 2;
    // The industry stats based on state
    IndustryStats state = 3;
    // The industry stats based on city
    IndustryStats city = 4;
}

// A response containing the historical listing score for an account
message GetHistoricalScoreDataResponse {
    // The historical listing score of the account group.
    repeated HistoricalScoreDataPoint historical_score_data = 1;
}

// A response containing the listing presence values for an account
message GetListingPresenceResponse {
    // The actual listing count for that account
    int64 listing_count = 1;
    //The average listing count for all accounts under same taxonomy category
    float world_average = 2;
    //The average listing count for all accounts under same taxonomy category and same country
    float country_average = 3;
    //The average listing count for all accounts under same taxonomy category and same state
    float state_average = 4;
    //The average listing count for all accounts under same taxonomy category and same city
    float city_average = 5;
}

// A response containing the listing accuracy values for an account
message GetListingAccuracyResponse {
    // The actual listing accuracy for that account
    float listing_accuracy = 1;
    //The average listing accuracy for all accounts under same taxonomy category
    float world_average = 2;
    //The average listing accuracy for all accounts under same taxonomy category and same country
    float country_average = 3;
    //The average listing accuracy for all accounts under same taxonomy category and same state
    float state_average = 4;
    //The average listing accuracy for all accounts under same taxonomy category and same city
    float city_average = 5;
}

// Service for listing scores
service ListingScore {
    // Get a listing score for an account
    rpc GetScore (GetScoreRequest) returns (GetScoreResponse) {
        option (google.api.http) = {
            post: "/v1/listing-score/get"
            body: "*"
        };
    };
    // Create a listing score for an account
    rpc CreateScore (CreateScoreRequest) returns (CreateScoreResponse) {
        option (google.api.http) = {
            post: "/v1/listing-score/create"
            body: "*"
        };
    };
    // Get the industry stats based on taxonomy
    rpc GetIndustryStats (GetIndustryStatsRequest) returns (GetIndustryStatsResponse) {
        option (google.api.http) = {
            post: "/v1/industry-stats/get"
            body: "*"
        };
    };
    // Get the historical listing score for an account
    rpc GetHistoricalScoreData (GetHistoricalScoreDataRequest) returns (GetHistoricalScoreDataResponse) {
        option (google.api.http) = {
            post: "/v1/listing-score/historical/get"
            body: "*"
        };
    };
    // Get the listing presence data for an account
    rpc GetListingPresence (GetListingPresenceRequest) returns (GetListingPresenceResponse) {};
    // Get the listing accuracy data for an account
    rpc GetListingAccuracy (GetListingAccuracyRequest) returns (GetListingAccuracyResponse) {};
}
