syntax = "proto3";

package snapshot.v1;

import "snapshot/v1/snapshot.proto";
import "snapshot/v1/field_mask.proto";

// ReviewSection represents the entire review section of a snapshot
message ReviewSection {
    Grade grade = 1;
    SectionContent content = 2;
    ReviewData data = 3;
    ReviewConfig config = 4;
}

// ReviewConfig represents the configuration for the review section
message ReviewConfig {
    bool hide_content = 1;
    bool hide_reviews_found = 2;
    bool hide_reviews_found_per_month = 3;
    bool hide_average_review_score = 4;
    bool hide_number_of_review_sources = 5;
    string customized_message = 6;
}

// ReviewData represents the review data found for a business and related industry averages
message ReviewData {
    ReviewDataItem reviews_found = 1;
    ReviewDataItem reviews_found_per_month = 2;
    ReviewDataItem average_review_score = 3;
    ReviewDataItem number_of_review_sources = 4; 
    repeated SampleSourceCount sample_source_counts = 5;
}   

message SampleSourceCount {
    string source_name = 1;
    int64 review_count = 2;
}

// ReviewDataItem is a holder for each row of the info section
message ReviewDataItem {
    // The grade of the item
    Grade grade = 1;
    // The value of the item for a business
    float business = 2;
    // The industry average  
    float industry_average = 3;
}

message UpdateReviewConfigRequest {
    // The id of the snapshot to update a section for
    string snapshot_id = 1;
    ReviewConfig review_config = 2;

    // Mask for what fields should be updated
    FieldMask field_mask = 20;
}

message GetReviewSectionResponse {
    ReviewSection section = 1;
}